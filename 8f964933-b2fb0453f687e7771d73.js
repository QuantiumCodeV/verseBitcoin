/*! For license information please see 8f964933-b2fb0453f687e7771d73.js.LICENSE.txt */
"use strict";(self.webpackChunkbitcoincom_verse_dex=self.webpackChunkbitcoincom_verse_dex||[]).push([[5079],{58850:function(e,t){function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(m){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===_(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}(this,r)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function d(){d=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(P){c=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var o=t&&t.prototype instanceof p?t:p,s=Object.create(o.prototype),a=new A(i||[]);return n(s,"_invoke",{value:S(e,r,a)}),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}e.wrap=u;var h={};function p(){}function f(){}function v(){}var m={};c(m,o,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(E([])));b&&b!==t&&r.call(b,o)&&(m=b);var g=v.prototype=p.prototype=Object.create(m);function k(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(n,o,s,a){var c=l(e[n],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==_(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,a)}),(function(e){i("throw",e,s,a)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,a)}))}a(c.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function S(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return x()}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=O(s,r);if(a){if(a===h)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),h;var i=l(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,h;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=v,n(g,"constructor",{value:v,configurable:!0}),n(v,"constructor",{value:f,configurable:!0}),f.displayName=c(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,a,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},k(w.prototype),c(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new w(u(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},k(g),c(g,a,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=E,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),h}},e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,v(n.key),n)}}function f(e,t,r){return t&&p(e.prototype,t),r&&p(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function v(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===_(t)?t:String(t)}function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=b(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw o}}}}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,s,a=[],c=!0,u=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=o.call(r)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){u=!0,i=e}finally{try{if(!c&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k(e){return k="function"==typeof Symbol&&"symbol"==_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},k(e)}function w(){w=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n=Object.defineProperty||function(e,t,r){e[t]=r.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var o=t&&t.prototype instanceof h?t:h,s=Object.create(o.prototype),a=new A(i||[]);return n(s,"_invoke",{value:S(e,r,a)}),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d={};function h(){}function p(){}function f(){}var v={};c(v,o,(function(){return this}));var _=Object.getPrototypeOf,m=_&&_(_(E([])));m&&m!==t&&r.call(m,o)&&(v=m);var y=f.prototype=h.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function g(e,t){function i(n,o,s,a){var c=l(e[n],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==k(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){i("next",e,s,a)}),(function(e){i("throw",e,s,a)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return i("throw",e,s,a)}))}a(c.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function S(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=O(s,r);if(a){if(a===d)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=l(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=f,n(y,"constructor",{value:f,configurable:!0}),n(f,"constructor",{value:p,configurable:!0}),p.displayName=c(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},b(g.prototype),c(g.prototype,s,(function(){return this})),e.AsyncIterator=g,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new g(u(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},b(y),c(y,a,"Generator"),c(y,o,(function(){return this})),c(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=E,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e){if("object"!==k(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===k(i)?i:String(i)),n)}var i}function O(e,t,r){return t&&S(e.prototype,t),r&&S(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}function A(e){var t=R();return function(){var r,n=L(e);if(t){var i=L(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return E(e)}(this,r)}}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){var t="function"==typeof Map?new Map:void 0;return x=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return P(e,arguments,L(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),D(n,e)},x(e)}function P(e,t,r){return P=R()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&D(i,r.prototype),i},P.apply(null,arguments)}function R(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(m){return!1}}function D(e,t){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},D(e,t)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var I,B,j,F,N,M,U="https://accounts.google.com/gsi",K="".concat(U,"/client");function W(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function G(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}!function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords"}(I||(I={})),function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Salesforce="salesforce",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch",e.Twitter="twitter",e.TikTok="tiktok",e.Snapchat="snapchat",e.Figma="figma",e.Yahoo="yahoo"}(B||(B={})),function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(j||(j={})),function(e){e.embedded="embedded",e.floating="floating"}(F||(F={})),function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(N||(N={})),function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL",e.B2BMagicLinkEmailLoginOrSignup="B2B_MAGIC_LINK_EMAIL_LOGIN_OR_SIGNUP",e.B2BMagicLinkAuthenticate="B2B_MAGIC_LINK_AUTHENTICATE",e.B2BMagicLinkEmailDiscoverySend="B2B_MAGIC_LINK_EMAIL_DISCOVERY_SEND",e.B2BMagicLinkDiscoveryAuthenticate="B2B_MAGIC_LINK_DISCOVERY_AUTHENTICATE",e.B2BSSOStart="B2B_SSO_START",e.B2BSSOAuthenticate="B2B_SSO_AUTHENTICATE",e.B2BOAuthAuthenticate="B2B_SSO_AUTHENTICATE",e.B2BOAuthDiscoveryAuthenticate="B2B_OAUTH_DISCOVERY_AUTHENTICATE",e.B2BDiscoveryOrganizationsCreate="B2B_DISCOVERY_ORGANIZATIONS_CREATE",e.B2BDiscoveryIntermediateSessionExchange="B2B_DISCOVERY_INTERMEDIATE_SESSION_EXCHANGE",e.B2BPasswordAuthenticate="B2B_PASSWORD_AUTHENTICATE",e.B2BPasswordResetByEmailStart="B2B_PASSWORD_RESET_BY_EMAIL_START",e.B2BPasswordResetByEmail="B2B_PASSWORD_RESET_BY_EMAIL",e.B2BPasswordResetBySession="B2B_PASSWORD_RESET_BY_SESSION"}(M||(M={}));var q,H,z,V,Y,J=function(){C(t,x(Error));var e=A(t);function t(r,n){var i;return T(this,t),(i=e.call(this,r+"\n"+n)).message=r+"\n"+n,i.name="SDKAPIUnreachableError",i.details=n,Object.setPrototypeOf(E(i),t.prototype),i}return O(t)}(),X=function(){C(t,x(Error));var e=A(t);function t(r,n){var i;return T(this,t),(i=e.call(this)).name="StytchSDKUsageError",i.message="Invalid call to ".concat(r,"\n")+n,i}return O(t)}(),$=function(){C(t,x(Error));var e=A(t);function t(r){var n,i;T(this,t),(n=e.call(this)).name="StytchSDKSchemaError";var o=null===(i=r.body)||void 0===i?void 0:i.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return n.message="[400] Request does not match expected schema\n".concat(o),n}return O(t)}(),Z=function(){C(t,x(Error));var e=A(t);function t(r){var n;T(this,t),(n=e.call(this)).name="StytchSDKAPIError";var i=r.status_code,o=r.error_type,s=r.error_message,a=r.error_url,c=r.request_id;return n.error_type=o,n.error_message=s,n.error_url=a,n.request_id=c,n.status_code=i,n.message="[".concat(i,"] ").concat(o,"\n")+"".concat(s,"\n")+"See ".concat(a," for more information.\n")+(c?"request_id: ".concat(c,"\n"):""),n}return O(t)}(),Q=["unauthorized_credentials","user_unauthenticated","invalid_secret_authentication","session_not_found"];!function(e){e.BiometricsSensorError="biometrics_sensor_error",e.DeviceCredentialsNotAllowed="device_credentials_not_allowed",e.DeviceHardwareError="device_hardware_error",e.InternalError="internal_error",e.KeyInvalidated="key_invalidated",e.KeystoreUnavailable="keystore_unavailable",e.NoBiometricsEnrolled="no_biometrics_enrolled",e.NoBiometricsRegistration="no_biometrics_registration",e.SessionExpired="session_expired",e.UserCancellation="user_cancellation",e.UserLockedOut="user_locked_out",e.BiometricsNotAvailable="biometrics_not_available"}(q||(q={})),function(e){e.emailMagicLinks="emailMagicLinks",e.sso="sso",e.passwords="passwords",e.oauth="oauth"}(H||(H={})),function(e){e.Discovery="Discovery",e.Organization="Organization",e.PasswordReset="PasswordReset"}(z||(z={})),function(e){e.Google="google",e.Microsoft="microsoft"}(V||(V={})),function(e){e.RequiredCatcha="Catcha Required"}(Y||(Y={}));var ee,te=function(){C(t,x(Error));var e=A(t);function t(r){var n;return T(this,t),(n=e.call(this,r)).type=r,n}return O(t)}();function re(e){var t=e.method,r=e.errorMessage,n=e.finalURL,i=e.basicAuthHeader,o=e.xSDKClientHeader,s=e.xSDKParentHostHeader,a=e.body;return G(this,void 0,void 0,w().mark((function e(){var c,u,l,d,h,p;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={Authorization:i,"Content-Type":"application/json","X-SDK-Client":o},s&&(c["X-SDK-Parent-Host"]=s),u={method:t,headers:c,body:a&&JSON.stringify(a)},e.prev=3,e.next=6,fetch(n,u);case 6:l=e.sent,e.next=14;break;case 9:if(e.prev=9,e.t0=e.catch(3),"Failed to fetch"!==e.t0.message){e.next=13;break}throw new J(r,"Unable to contact the Stytch servers. Are you online?");case 13:throw e.t0;case 14:if(403!==l.status){e.next=27;break}return e.prev=15,e.next=18,l.text();case 18:d=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),new J(r,"Invalid response from the Stytch servers.");case 24:if(!d.includes("Captcha required")){e.next=26;break}throw new te(Y.RequiredCatcha);case 26:throw new J(r,"Invalid response from the Stytch servers.");case 27:if(200===l.status){e.next=40;break}return e.prev=28,e.next=31,l.json();case 31:h=e.sent,e.next=37;break;case 34:throw e.prev=34,e.t2=e.catch(28),new J(r,"Invalid or no response from server");case 37:if(!("body"in h||"params"in h||"query"in h)){e.next=39;break}throw new $(h);case 39:throw new Z(h);case 40:return e.prev=40,e.next=43,l.json();case 43:return p=e.sent,e.abrupt("return",p.data);case 47:throw e.prev=47,e.t3=e.catch(40),new J(r,"Invalid response from the Stytch servers.");case 50:case"end":return e.stop()}}),e,null,[[3,9],[15,21],[28,34],[40,47]])})))}var ne=new Uint8Array(16);function ie(){if(!ee&&!(ee="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ee(ne)}for(var oe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,se=[],ae=0;ae<256;++ae)se.push((ae+256).toString(16).substr(1));function ce(e,t,r){var n=(e=e||{}).random||(e.rng||ie)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(se[e[t+0]]+se[e[t+1]]+se[e[t+2]]+se[e[t+3]]+"-"+se[e[t+4]]+se[e[t+5]]+"-"+se[e[t+6]]+se[e[t+7]]+"-"+se[e[t+8]]+se[e[t+9]]+"-"+se[e[t+10]]+se[e[t+11]]+se[e[t+12]]+se[e[t+13]]+se[e[t+14]]+se[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&oe.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r}(n)}var ue={};function le(e,t){return G(this,void 0,void 0,w().mark((function r(){return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(void 0===ue[e]){r.next=2;break}return r.abrupt("return",ue[e]);case 2:return ue[e]=de(e,t),r.abrupt("return",ue[e]);case 4:case"end":return r.stop()}}),r)})))}function de(e,t){return new Promise((function(r,n){var i=function(e){var t=pe(e);if(t[0])return t[0]}(e);if(i&&"true"===i.dataset.loaded)try{r(t())}catch(t){return n(new Error("".concat(e," already loaded, but module was not found in global scope: ").concat(t)))}var o=function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("async","true"),t.setAttribute("defer","true"),document.head.appendChild(t),t}(e);o.addEventListener("load",(function(){o.dataset.loaded="true";try{r(t())}catch(t){n(new Error("".concat(e," was loaded, but module was not found in global scope: ").concat(t)))}})),o.addEventListener("error",(function(t){n(new Error("".concat(e," could not be loaded: ").concat(t)))}))}))}var he,pe=function(e){return document.querySelectorAll('script[src="'.concat(e,'"]'))},fe=["[Stytch]"],ve=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=console).warn.apply(e,fe.concat(r))},_e="\nYou can find your public token at https://stytch.com/dashboard/api-keys.",me=function(e){var t={isObject:function(r,n){if(!("object"===k(n)&&!Array.isArray(n)&&null!==n))throw new X(e,r+" must be an object.");return t},isOptionalObject:function(e,r){return void 0===r?t:t.isObject(e,r)},isString:function(r,n){if("string"!=typeof n)throw new X(e,r+" must be a string.");return t},isOptionalString:function(e,r){return void 0===r?t:t.isString(e,r)},isStringArray:function(r,n){if(!Array.isArray(n))throw new X(e,r+" must be an array of strings.");var i,o=m(n);try{for(o.s();!(i=o.n()).done;)if("string"!=typeof i.value)throw new X(e,r+" must be an array of strings.")}catch(m){o.e(m)}finally{o.f()}return t},isOptionalStringArray:function(e,r){return void 0===r?t:t.isStringArray(e,r)},isNumber:function(r,n){if("number"!=typeof n)throw new X(e,r+" must be a number.");return t},isOptionalNumber:function(e,r){return void 0===r?t:t.isNumber(e,r)},isBoolean:function(r,n){if("boolean"!=typeof n)throw new X(e,r+" must be a boolean.");return t},isOptionalBoolean:function(e,r){return void 0===r?t:t.isBoolean(e,r)}};return t},ye=function(e){return W(e,["request_id","status_code"])},be=function(e){return W(e,["__user"])},ge=O((function e(t,r,n){var i=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){return Promise.resolve(void 0)};T(this,e),this.bootstrapPromise=n,this.isEnabled=function(){return G(i,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.state.then((function(e){return e.enabled})));case 1:case"end":return e.stop()}}),e,this)})))},this.getTelemetryID=function(){return G(i,void 0,void 0,w().mark((function e(){var t,r,n,i;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.publicToken,n=t.enabled,i=t.dfpBackendURL,n){e.next=8;break}return e.abrupt("return",void 0);case 8:return e.next=10,window.GetTelemetryID(r,"".concat(i,"/submit"));case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})))},this.getDFPTelemetryIDAndCaptcha=function(){return G(i,void 0,void 0,w().mark((function e(){var t,r,n,i,o,s;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.enabled,n=t.executeRecaptcha,i=t.mode,o=void 0,s=void 0,r){e.next=12;break}return e.next=11,n();case 11:s=e.sent;case 12:if("DECISIONING"!==i){e.next=18;break}return e.next=15,this.getTelemetryID();case 15:o=e.sent,e.next=25;break;case 18:if("OBSERVATION"!==i){e.next=25;break}return e.next=21,this.getTelemetryID();case 21:return o=e.sent,e.next=24,n();case 24:s=e.sent;case 25:return e.abrupt("return",{dfp_telemetry_id:o,captcha_token:s});case 26:case"end":return e.stop()}}),e,this)})))},this.retryWithCaptchaAndDFP=function(e,t){return G(i,void 0,void 0,w().mark((function r(){var n,i,o;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.state;case 2:if(n=r.sent,i=n.enabled,o=n.executeRecaptcha,e.type!==Y.RequiredCatcha||!i){r.next=14;break}if(!t.body){r.next=13;break}return r.next=9,this.getTelemetryID();case 9:return t.body.dfp_telemetry_id=r.sent,r.next=12,o();case 12:t.body.captcha_token=r.sent;case 13:return r.abrupt("return",t);case 14:throw new Error("Unable to query captcha and/or dfp telemetry ID");case 15:case"end":return r.stop()}}),r,this)})))},this.state=n.then((function(e){return G(i,void 0,void 0,w().mark((function n(){return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.runDFPProtectedAuth){n.next=2;break}return n.abrupt("return",{publicToken:t,dfpBackendURL:r,enabled:!1,loaded:!1,executeRecaptcha:o});case 2:return n.next=4,void le("".concat("https://elements.stytch.com","/telemetry.js"),(function(){return window}));case 4:return n.abrupt("return",{publicToken:t,dfpBackendURL:r,enabled:!0,mode:e.dfpProtectedAuthMode||"OBSERVATION",loaded:!0,executeRecaptcha:o});case 5:case"end":return n.stop()}}),n)})))}))})),ke=function(){return{isEnabled:function(){return G(void 0,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})))},getTelemetryID:function(){return G(void 0,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})))},getDFPTelemetryIDAndCaptcha:function(){return G(void 0,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{dfp_telemetry_id:void 0,captcha_token:void 0});case 1:case"end":return e.stop()}}),e)})))},retryWithCaptchaAndDFP:function(){return G(void 0,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("DFP protected auth is disabled");case 1:case"end":return e.stop()}}),e)})))}}},we=function(){function e(){T(this,e)}return O(e,null,[{key:"marshall",value:function(e){return Object.assign(Object.assign({},e),{name:e.name,message:e.message,stack:e.stack})}},{key:"inflate",value:function(e,t){var r=new e(t);return Object.assign(r,t),Object.setPrototypeOf(r,e.prototype),r}},{key:"unmarshall",value:function(t){if("name"in t)switch(t.name){case"SDKAPIUnreachableError":return e.inflate(J,t);case"StytchSDKSchemaError":return e.inflate($,t);case"StytchSDKAPIError":return e.inflate(Z,t);case"TypeError":return e.inflate(TypeError,t);case"SyntaxError":return e.inflate(SyntaxError,t);case"ReferenceError":return e.inflate(ReferenceError,t);case"RangeError":return e.inflate(RangeError,t);case"EvalError":return e.inflate(EvalError,t);case"URIError":return e.inflate(URIError,t)}return e.inflate(Error,t)}}]),e}(),Se=function(){function e(t){T(this,e),this.maxBatchSize=t.maxBatchSize,this.logEventURL=t.logEventURL,setInterval(this.flush.bind(this),t.intervalDurationMs),this.batch=[]}return O(e,[{key:"logEvent",value:function(e,t){this.batch.push({telemetry:e,event:t}),this.batch.length>=this.maxBatchSize&&this.flush()}},{key:"flush",value:function(){return G(this,void 0,void 0,w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.batch.length){e.next=2;break}return e.abrupt("return");case 2:return t=this.batch,this.batch=[],e.prev=4,e.next=7,fetch(this.logEventURL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(4);case 11:case"end":return e.stop()}}),e,this,[[4,9]])})))}}]),e}();!function(e){e.LoginOrCreateEML="login_or_create_eml",e.LoginOrCreateOTP="login_or_create_otp",e.ResetPassword="reset_password"}(he||(he={}));var Oe=O((function e(t,r){var n=this;T(this,e),this._networkClient=t,this._subscriptionService=r,this.get=function(){return G(n,void 0,void 0,w().mark((function e(){var t,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._networkClient.fetchSDK({url:"/users/me",errorMessage:"Failed to retrieve user info.",method:"GET"});case 2:return t=e.sent,r=ye(t),this._subscriptionService.updateUser(r),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})))},this.getSync=function(){return n._subscriptionService.getUser()},this.update=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.user.update").isOptionalObject("untrusted_metadata",e.untrusted_metadata),t.next=3,this._networkClient.fetchSDK({url:"/users/me",body:e,errorMessage:"Failed to update user.",method:"PUT"});case 3:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 7:case"end":return t.stop()}}),t,this)})))},this.deleteEmail=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/emails/".concat(e),errorMessage:"Failed to delete email.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deletePhoneNumber=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/phone_numbers/".concat(e),errorMessage:"Failed to delete phone number.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteTOTP=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/totps/".concat(e),errorMessage:"Failed to delete TOTP.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteOAuthRegistration=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/oauth/".concat(e),errorMessage:"Failed to delete OAuth registration.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteWebauthnRegistration=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/webauthn_registrations/".concat(e),errorMessage:"Failed to delete WebAuthn registration.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.deleteBiometricRegistration=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._networkClient.fetchSDK({url:"/users/biometric_registrations/".concat(e),errorMessage:"Failed to delete Biometric registration.",method:"DELETE"});case 2:return r=t.sent,n=ye(r.__user),this._subscriptionService.updateUser(n),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))},this.onChange=function(e){var t=n._subscriptionService.getUser();return n._subscriptionService.subscribeToState((function(r){var n;(null==r?void 0:r.user)!==t&&(t=null!==(n=null==r?void 0:r.user)&&void 0!==n?n:null,e(t))}))}})),Te=function(){function e(t,r){var n=this;T(this,e),this._networkClient=t,this._subscriptionService=r,this.getSync=function(){return n._subscriptionService.getSession()},this.onChange=function(e){var t=n._subscriptionService.getSession();return n._subscriptionService.subscribeToState((function(r){var n;(null==r?void 0:r.session)!==t&&(t=null!==(n=null==r?void 0:r.session)&&void 0!==n?n:null,e(t))}))},this.revoke=function(e){return G(n,void 0,void 0,w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this._networkClient.fetchSDK({url:"/sessions/revoke",errorMessage:"Error revoking session",method:"POST"});case 3:return r=t.sent,this._subscriptionService.destroyState(),t.abrupt("return",r);case 8:throw t.prev=8,t.t0=t.catch(0),((null==e?void 0:e.forceClear)||Q.includes(t.t0.error_type))&&this._subscriptionService.destroyState(),t.t0;case 12:case"end":return t.stop()}}),t,this,[[0,8]])})))},this.authenticate=function(e){return G(n,void 0,void 0,w().mark((function t(){var r,n;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={session_duration_minutes:null==e?void 0:e.session_duration_minutes},t.next=4,this._networkClient.fetchSDK({url:"/sessions/authenticate",body:r,errorMessage:"Error authenticating session",method:"POST"});case 4:return n=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:n.session,user:n.user},session_token:n.session_token,session_jwt:n.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(n));case 9:throw t.prev=9,t.t0=t.catch(0),Q.includes(t.t0.error_type)&&this._subscriptionService.destroyState(),t.t0;case 13:case"end":return t.stop()}}),t,this,[[0,9]])})))}}return O(e,[{key:"getTokens",value:function(){return this._subscriptionService.getTokens()}},{key:"updateSession",value:function(e){this._subscriptionService.updateTokens(e)}}]),e}(),Ce=Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),Ae=function(){function e(t,r,n,i){var o=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ce,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ke();T(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._passwordResetPKCEManager=i,this._config=s,this.dfpProtectedAuth=a,this.email={loginOrCreate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(o,void 0,void 0,w().mark((function r(){var n,i,o,s,a,c,u;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,i=n.pkceRequiredForEmailMagicLinks,o=void 0,!i){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:o=r.sent;case 9:return r.next=11,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 11:return s=r.sent,a=s.dfp_telemetry_id,c=s.captcha_token,u=Object.assign(Object.assign({},t),{email:e,code_challenge:o,captcha_token:c,dfp_telemetry_id:a}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/magic_links/email/login_or_create",body:u,errorMessage:"Failed to send magic link",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 16:case"end":return r.stop()}}),r,this)})))},send:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(o,void 0,void 0,w().mark((function r(){var n,i,o,s,a,c,u,l,d;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._config;case 2:if(n=r.sent,i=n.pkceRequiredForEmailMagicLinks,o=void 0,!i){r.next=9;break}return r.next=8,this.getCodeChallenge();case 8:o=r.sent;case 9:return r.next=11,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 11:return s=r.sent,a=s.dfp_telemetry_id,c=s.captcha_token,u=Object.assign(Object.assign({},t),{email:e,code_challenge:o,captcha_token:c,dfp_telemetry_id:a}),l=!!this._subscriptionService.getSession(),d=l?"/magic_links/email/send/secondary":"/magic_links/email/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:d,body:u,errorMessage:"Failed to send magic link",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 18:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t){return G(o,void 0,void 0,w().mark((function r(){var n,i;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return me("stytch.magicLinks.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),r.next=3,this._passwordResetPKCEManager.getPKPair();case 3:if(n=r.sent,i=null,!(null==n?void 0:n.code_verifier)){r.next=19;break}return r.prev=6,r.next=9,this.handlePKCEForAuthenticate(this._passwordResetPKCEManager,Object.assign(Object.assign({},t),{token:e}));case 9:i=r.sent,r.next=19;break;case 12:if(r.prev=12,r.t0=r.catch(6),!r.t0.message.includes("pkce")){r.next=18;break}console.log("Authenticate with passwords pkce namespace failed. Falling back to authenticate with magic_links namespace."),r.next=19;break;case 18:throw r.t0;case 19:if(i){r.next=23;break}return r.next=22,this.handlePKCEForAuthenticate(this._pkceManager,Object.assign(Object.assign({},t),{token:e}));case 22:i=r.sent;case 23:return this._subscriptionService.updateStateAndTokens({state:{session:i.session,user:i.user},session_token:i.session_token,session_jwt:i.session_jwt,intermediate_session_token:null}),r.abrupt("return",be(i));case 25:case"end":return r.stop()}}),r,this,[[6,12]])})))}}return O(e,[{key:"getCodeChallenge",value:function(){return G(this,void 0,void 0,w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pkceManager.getPKPair();case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t.code_challenge);case 5:return e.next=7,this._pkceManager.startPKCETransaction();case 7:return t=e.sent,e.abrupt("return",t.code_challenge);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"handlePKCEForAuthenticate",value:function(e,t){return G(this,void 0,void 0,w().mark((function r(){var n,i,o;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getPKPair();case 2:return n=r.sent,i=Object.assign({code_verifier:null==n?void 0:n.code_verifier},t),r.next=6,this._networkClient.fetchSDK({url:"/magic_links/authenticate",body:i,errorMessage:"Failed to authenticate token.",method:"POST"});case 6:return o=r.sent,e.clearPKPair(),r.abrupt("return",o);case 9:case"end":return r.stop()}}),r,this)})))}}]),e}(),Ee=O((function e(t,r){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ke();T(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=i,this.dfpProtectedAuth=o,this.sms={loginOrCreate:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i,o,s;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/otps/sms/login_or_create",body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 7:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i,o,s,a,c;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),a=!!this._subscriptionService.getSession(),c=a?"/otps/sms/send/secondary":"/otps/sms/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:c,body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 9:case"end":return r.stop()}}),r,this)})))}},this.whatsapp={loginOrCreate:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i,o,s;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,dfp_telemetry_id:i,captcha_token:o}),r.abrupt("return",this._networkClient.retriableFetchSDK({url:"/otps/whatsapp/login_or_create",body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 7:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i,o,s,a,c;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 2:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,s=Object.assign(Object.assign({},t),{phone_number:e,captcha_token:o,dfp_telemetry_id:i}),a=!!this._subscriptionService.getSession(),c=a?"/otps/whatsapp/send/secondary":"/otps/whatsapp/send/primary",r.abrupt("return",this._networkClient.retriableFetchSDK({url:c,body:s,errorMessage:"Failed to send one time passcode",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 9:case"end":return r.stop()}}),r,this)})))}},this.email={loginOrCreate:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,i=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),r.abrupt("return",this._networkClient.fetchSDK({url:"/otps/email/login_or_create",body:i,errorMessage:"Failed to send one time passcode",method:"POST"}));case 5:case"end":return r.stop()}}),r,this)})))},send:function(e,t){return G(n,void 0,void 0,w().mark((function r(){var n,i,o,s;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.executeRecaptcha();case 2:return n=r.sent,i=Object.assign(Object.assign({},t),{email:e,captcha_token:n}),o=!!this._subscriptionService.getSession(),s=o?"/otps/email/send/secondary":"/otps/email/send/primary",r.abrupt("return",this._networkClient.fetchSDK({url:s,body:i,errorMessage:"Failed to send one time passcode",method:"POST"}));case 7:case"end":return r.stop()}}),r,this)})))}},this.authenticate=function(e,t,r){return G(n,void 0,void 0,w().mark((function n(){var i,o,s,a,c;return w().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return me("stytch.otps.authenticate").isString("Code",e).isNumber("session_duration_minutes",r.session_duration_minutes),n.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return i=n.sent,o=i.dfp_telemetry_id,s=i.captcha_token,a=Object.assign({token:e,method_id:t,dfp_telemetry_id:o,captcha_token:s},r),n.next=9,this._networkClient.retriableFetchSDK({url:"/otps/authenticate",body:a,errorMessage:"Failed to authenticate token.",method:"POST",retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 9:return c=n.sent,this._subscriptionService.updateStateAndTokens({state:{session:c.session,user:c.user},session_token:c.session_token,session_jwt:c.session_jwt,intermediate_session_token:null}),n.abrupt("return",be(c));case 12:case"end":return n.stop()}}),n,this)})))}})),xe=function(){function e(t,r,n,i,o){T(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._dynamicConfig=i,this._config=o,this.google={start:this.startOAuthFlow(B.Google)},this.apple={start:this.startOAuthFlow(B.Apple)},this.microsoft={start:this.startOAuthFlow(B.Microsoft)},this.github={start:this.startOAuthFlow(B.Github)},this.gitlab={start:this.startOAuthFlow(B.GitLab)},this.facebook={start:this.startOAuthFlow(B.Facebook)},this.discord={start:this.startOAuthFlow(B.Discord)},this.salesforce={start:this.startOAuthFlow(B.Salesforce)},this.slack={start:this.startOAuthFlow(B.Slack)},this.amazon={start:this.startOAuthFlow(B.Amazon)},this.bitbucket={start:this.startOAuthFlow(B.Bitbucket)},this.linkedin={start:this.startOAuthFlow(B.LinkedIn)},this.coinbase={start:this.startOAuthFlow(B.Coinbase)},this.twitch={start:this.startOAuthFlow(B.Twitch)},this.twitter={start:this.startOAuthFlow(B.Twitter)},this.tiktok={start:this.startOAuthFlow(B.TikTok)},this.snapchat={start:this.startOAuthFlow(B.Snapchat)},this.figma={start:this.startOAuthFlow(B.Figma)},this.yahoo={start:this.startOAuthFlow(B.Yahoo)}}return O(e,[{key:"authenticate",value:function(e,t){return G(this,void 0,void 0,w().mark((function r(){var n,i;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return me("stytch.oauth.authenticate").isString("Token",e).isNumber("session_duration_minutes",t.session_duration_minutes),r.next=3,this._pkceManager.getPKPair();case 3:return(n=r.sent)||ve("No code verifier found in local storage for OAuth flow.\nConsider using stytch.oauth.$provider.start() to add PKCE to your OAuth flows for added security.\nSee https://stytch.com/docs/oauth#guides_pkce for more information."),r.next=7,this._networkClient.fetchSDK({url:"/oauth/authenticate",method:"POST",body:Object.assign({token:e,code_verifier:null==n?void 0:n.code_verifier},t),errorMessage:"Failed to authenticate token"});case 7:return i=r.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateStateAndTokens({state:{session:i.session,user:ye(i.__user)},session_token:i.session_token,session_jwt:i.session_jwt,intermediate_session_token:null}),r.abrupt("return",be(i));case 11:case"end":return r.stop()}}),r,this)})))}},{key:"getBaseApiUrl",value:function(){return G(this,void 0,void 0,w().mark((function e(){var t,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._dynamicConfig;case 2:if(t=e.sent,!(r=t.cnameDomain)){e.next=6;break}return e.abrupt("return","https://".concat(r));case 6:if(!this._config.publicToken.includes("public-token-test")){e.next=8;break}return e.abrupt("return",this._config.testAPIURL);case 8:return e.abrupt("return",this._config.liveAPIURL);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"startOAuthFlow",value:function(e){var t=this;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.login_redirect_url,i=r.signup_redirect_url,o=r.custom_scopes;return G(t,void 0,void 0,w().mark((function t(){var r,s,a,c,u,l;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._dynamicConfig;case 2:return r=t.sent,s=r.cnameDomain,a=r.pkceRequiredForOAuth,t.next=7,this.getBaseApiUrl();case 7:if(c=t.sent,this._networkClient.logEvent({name:"start_oauth_flow",details:{provider_type:e,custom_scopes:o,cname_domain:s,pkce:a}}),(u=new URL("".concat(c,"/v1/public/oauth/").concat(e,"/start"))).searchParams.set("public_token",this._config.publicToken),!a){t.next=18;break}return t.next=14,this._pkceManager.startPKCETransaction();case 14:l=t.sent,u.searchParams.set("code_challenge",l.code_challenge),t.next=19;break;case 18:this._pkceManager.clearPKPair();case 19:o&&(me("startOAuthFlow").isStringArray("custom_scopes",o),u.searchParams.set("custom_scopes",o.join(" "))),n&&u.searchParams.set("login_redirect_url",n),i&&u.searchParams.set("signup_redirect_url",i),window.location.href=u.toString();case 23:case"end":return t.stop()}}),t,this)})))}}}]),e}(),Pe=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return Promise.resolve(void 0)},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ke();T(this,e),this._networkClient=t,this._subscriptionService=r,this.executeRecaptcha=n,this.dfpProtectedAuth=i}return O(e,[{key:"authenticateStart",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.cryptoWallets.authenticateStart").isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type),r=!!this._subscriptionService.getSession(),t.next=4,this.executeRecaptcha();case 4:return n=t.sent,i=r?"/crypto_wallets/authenticate/start/secondary":"/crypto_wallets/authenticate/start/primary",t.abrupt("return",this._networkClient.fetchSDK({url:i,method:"POST",errorMessage:"Failed to start wallet authentication.",body:{crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,captcha_token:n}}));case 7:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.cryptoWallets.authenticate").isString("signature",e.signature).isString("crypto_wallet_address",e.crypto_wallet_address).isString("crypto_wallet_type",e.crypto_wallet_type).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/crypto_wallets/authenticate",method:"POST",errorMessage:"Failed to authenticate.",body:{session_duration_minutes:e.session_duration_minutes,crypto_wallet_address:e.crypto_wallet_address,crypto_wallet_type:e.crypto_wallet_type,signature:e.signature,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:ye(o.__user)},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}}]),e}(),Re=function(){function e(t,r,n){T(this,e),this._networkClient=t,this._subscriptionService=r,this.dfpProtectedAuth=n}return O(e,[{key:"create",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.totps.create").isNumber("expiration_minutes",e.expiration_minutes),t.next=3,this._networkClient.fetchSDK({url:"/totps",method:"POST",errorMessage:"Failed to create TOTP",body:{expiration_minutes:e.expiration_minutes}});case 3:return r=t.sent,this._subscriptionService.updateUser(r.__user),t.abrupt("return",be(r));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.totps.authenticate").isNumber("session_duration_minutes",e.session_duration_minutes).isString("totp_code",e.totp_code),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/totps/authenticate",method:"POST",errorMessage:"Failed to authenticate TOTP",body:{session_duration_minutes:e.session_duration_minutes,totp_code:e.totp_code,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.__user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"recoveryCodes",value:function(){return G(this,void 0,void 0,w().mark((function e(){return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._networkClient.fetchSDK({url:"/totps/recovery_codes",method:"POST",errorMessage:"Failed to retrieve recovery codes"}));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"recover",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.totps.recover").isNumber("session_duration_minutes",e.session_duration_minutes).isString("recovery_code",e.recovery_code),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/totps/recover",method:"POST",errorMessage:"Failed to recover TOTP",body:{session_duration_minutes:e.session_duration_minutes,recovery_code:e.recovery_code,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.__user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}}]),e}();function De(e){for(var t="==".slice(0,(4-e.length%4)%4),r=e.replace(/-/g,"+").replace(/_/g,"/")+t,n=atob(r),i=new ArrayBuffer(n.length),o=new Uint8Array(i),s=0;s<n.length;s++)o[s]=n.charCodeAt(s);return i}function Le(e){var t,r="",n=m(new Uint8Array(e));try{for(n.s();!(t=n.n()).done;){var i=t.value;r+=String.fromCharCode(i)}}catch(m){n.e(m)}finally{n.f()}return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}var Ie="copy",Be="convert";function je(e,t,r){if(t===Ie)return r;if(t===Be)return e(r);if(t instanceof Array)return r.map((function(r){return je(e,t[0],r)}));if(t instanceof Object){for(var n={},i=0,o=Object.entries(t);i<o.length;i++){var s=y(o[i],2),a=s[0],c=s[1];if(c.derive){var u=c.derive(r);void 0!==u&&(r[a]=u)}if(a in r)null!=r[a]?n[a]=je(e,c.schema,r[a]):n[a]=null;else if(c.required)throw new Error("Missing key: ".concat(a))}return n}}function Fe(e,t){return{required:!0,schema:e,derive:t}}function Ne(e){return{required:!0,schema:e}}function Me(e){return{required:!1,schema:e}}var Ue={type:Ne(Ie),id:Ne(Be),transports:Me(Ie)},Ke={appid:Me(Ie),appidExclude:Me(Ie),credProps:Me(Ie)},We={appid:Me(Ie),appidExclude:Me(Ie),credProps:Me(Ie)},Ge={publicKey:Ne({rp:Ne(Ie),user:Ne({id:Ne(Be),name:Ne(Ie),displayName:Ne(Ie)}),challenge:Ne(Be),pubKeyCredParams:Ne(Ie),timeout:Me(Ie),excludeCredentials:Me([Ue]),authenticatorSelection:Me(Ie),attestation:Me(Ie),extensions:Me(Ke)}),signal:Me(Ie)},qe={type:Ne(Ie),id:Ne(Ie),rawId:Ne(Be),authenticatorAttachment:Me(Ie),response:Ne({clientDataJSON:Ne(Be),attestationObject:Ne(Be),transports:Fe(Ie,(function(e){var t;return(null==(t=e.getTransports)?void 0:t.call(e))||[]}))}),clientExtensionResults:Fe(We,(function(e){return e.getClientExtensionResults()}))},He={mediation:Me(Ie),publicKey:Ne({challenge:Ne(Be),timeout:Me(Ie),rpId:Me(Ie),allowCredentials:Me([Ue]),userVerification:Me(Ie),extensions:Me(Ke)}),signal:Me(Ie)},ze={type:Ne(Ie),id:Ne(Ie),rawId:Ne(Be),authenticatorAttachment:Me(Ie),response:Ne({clientDataJSON:Ne(Be),authenticatorData:Ne(Be),signature:Ne(Be),userHandle:Ne(Be)}),clientExtensionResults:Fe(We,(function(e){return e.getClientExtensionResults()}))};function Ve(e){return je(De,Ge,e)}function Ye(e){return je(Le,qe,e)}function Je(e){return G(this,void 0,void 0,w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.create(Ve(e));case 2:return r=t.sent,t.abrupt("return",Ye(r));case 4:case"end":return t.stop()}}),t)})))}function Xe(e){return je(De,He,e)}function $e(e){return je(Le,ze,e)}function Ze(e){return G(this,void 0,void 0,w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.credentials.get(Xe(e));case 2:return r=t.sent,t.abrupt("return",$e(r));case 4:case"end":return t.stop()}}),t)})))}var Qe=function(){function e(t,r,n){T(this,e),this._networkClient=t,this._subscriptionService=r,this.dfpProtectedAuth=n}return O(e,[{key:"register",value:function(e){var t;return G(this,void 0,void 0,w().mark((function r(){var n,i,o,s;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return me("stytch.webauthn.register").isOptionalString("domain",null==e?void 0:e.domain).isOptionalString("authenticator_type",null==e?void 0:e.authenticator_type),r.next=3,this._networkClient.fetchSDK({url:"/webauthn/register/start",method:"POST",errorMessage:"Failed to start WebAuthn registration",body:{domain:null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:window.location.hostname,authenticator_type:null==e?void 0:e.authenticator_type}});case 3:return n=r.sent,i=n.public_key_credential_creation_options,r.next=7,Je({publicKey:JSON.parse(i)});case 7:return o=r.sent,r.next=10,this._networkClient.fetchSDK({url:"/webauthn/register",method:"POST",errorMessage:"Failed to register WebAuthn device",body:{public_key_credential:JSON.stringify(o)}});case 10:return s=r.sent,this._subscriptionService.updateUser(s.__user),r.abrupt("return",be(s));case 13:case"end":return r.stop()}}),r,this)})))}},{key:"authenticate",value:function(e){var t;return G(this,void 0,void 0,w().mark((function r(){var n,i,o,s,a,c,u;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return me("stytch.webauthn.register").isOptionalString("domain",e.domain).isNumber("session_duration_minutes",e.session_duration_minutes),r.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return n=r.sent,i=n.dfp_telemetry_id,o=n.captcha_token,r.next=8,this._networkClient.fetchSDK({url:"/webauthn/authenticate/start",method:"POST",errorMessage:"Failed to start WebAuthn authentication",body:{domain:null!==(t=e.domain)&&void 0!==t?t:window.location.hostname}});case 8:return s=r.sent,a=s.public_key_credential_request_options,r.next=12,Ze({publicKey:JSON.parse(a)});case 12:return c=r.sent,r.next=15,this._networkClient.retriableFetchSDK({url:"/webauthn/authenticate",method:"POST",errorMessage:"Failed to authenticate WebAuthn device",body:{public_key_credential:JSON.stringify(c),session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:i,captcha_token:o},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 15:return u=r.sent,this._subscriptionService.updateStateAndTokens({state:{session:u.session,user:u.__user},session_token:u.session_token,session_jwt:u.session_jwt,intermediate_session_token:null}),r.abrupt("return",be(u));case 18:case"end":return r.stop()}}),r,this)})))}}]),e}(),et=Promise.resolve({pkceRequiredForPasswordResets:!1}),tt=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:et,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ke();T(this,e),this._networkClient=t,this._subscriptionService=r,this._pkceManager=n,this._config=i,this.dfpProtectedAuth=o}return O(e,[{key:"getCodeChallenge",value:function(){return G(this,void 0,void 0,w().mark((function e(){var t;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._config;case 2:if(e.sent.pkceRequiredForPasswordResets){e.next=6;break}return e.abrupt("return",void 0);case 6:return e.next=8,this._pkceManager.getPKPair();case 8:if(!(t=e.sent)){e.next=11;break}return e.abrupt("return",t.code_challenge);case 11:return e.next=13,this._pkceManager.startPKCETransaction();case 13:return t=e.sent,e.abrupt("return",t.code_challenge);case 15:case"end":return e.stop()}}),e,this)})))}},{key:"create",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.create").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords",method:"POST",errorMessage:"Failed to create password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"authenticate",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.authenticate").isString("password",e.password).isString("email",e.email).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/authenticate",method:"POST",errorMessage:"Failed to authenticate password.",body:{email:e.email,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmailStart",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.resetByEmailStart").isString("email",e.email).isOptionalString("login_redirect_url",e.login_redirect_url).isOptionalString("reset_password_redirect_url",e.reset_password_redirect_url).isOptionalString("reset_password_template_id",e.reset_password_template_id).isOptionalNumber("reset_password_expiration_minutes",e.reset_password_expiration_minutes),t.next=3,this.getCodeChallenge();case 3:return r=t.sent,t.next=6,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 6:return n=t.sent,i=n.dfp_telemetry_id,o=n.captcha_token,t.abrupt("return",this._networkClient.retriableFetchSDK({url:"/passwords/email/reset/start",method:"POST",errorMessage:"Failed to start password reset flow.",body:{email:e.email,login_redirect_url:e.login_redirect_url,reset_password_redirect_url:e.reset_password_redirect_url,reset_password_expiration_minutes:e.reset_password_expiration_minutes,reset_password_template_id:e.reset_password_template_id,code_challenge:r,captcha_token:o,dfp_telemetry_id:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"resetByEmail",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o,s,a;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.resetByEmail").isString("token",e.token).isString("password",e.password).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._pkceManager.getPKPair();case 8:return o=t.sent,s=null==o?void 0:o.code_verifier,t.next=12,this._networkClient.retriableFetchSDK({url:"/passwords/email/reset",method:"POST",errorMessage:"Failed to reset password.",body:{token:e.token,password:e.password,session_duration_minutes:e.session_duration_minutes,captcha_token:i,code_verifier:s,dfp_telemetry_id:n},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 12:return a=t.sent,this._pkceManager.clearPKPair(),this._subscriptionService.updateStateAndTokens({state:{session:a.session,user:a.user},session_token:a.session_token,session_jwt:a.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(a));case 16:case"end":return t.stop()}}),t,this)})))}},{key:"resetByExistingPassword",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.resetByExistingPassword").isString("email",e.email).isString("existing_password",e.existing_password).isString("new_password",e.new_password).isNumber("session_duration_minutes",e.session_duration_minutes),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/existing_password/reset",method:"POST",errorMessage:"Failed to reset password.",body:{email:e.email,existing_password:e.existing_password,new_password:e.new_password,session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:n,captcha_token:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",be(o));case 11:case"end":return t.stop()}}),t,this)})))}},{key:"resetBySession",value:function(e){return G(this,void 0,void 0,w().mark((function t(){var r,n,i,o;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.resetBySession").isString("password",e.password),t.next=3,this.dfpProtectedAuth.getDFPTelemetryIDAndCaptcha();case 3:return r=t.sent,n=r.dfp_telemetry_id,i=r.captcha_token,t.next=8,this._networkClient.retriableFetchSDK({url:"/passwords/session/reset",method:"POST",errorMessage:"Failed to reset session.",body:{password:e.password,session_duration_minutes:e.session_duration_minutes,dfp_telemetry_id:n,captcha_token:i},retryCallback:this.dfpProtectedAuth.retryWithCaptchaAndDFP});case 8:return o=t.sent,this._subscriptionService.updateStateAndTokens({state:{session:o.session,user:o.user},session_token:o.session_token,session_jwt:o.session_jwt,intermediate_session_token:null}),t.abrupt("return",o);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"strengthCheck",value:function(e){return G(this,void 0,void 0,w().mark((function t(){return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return me("stytch.passwords.strengthCheck").isOptionalString("email",e.email).isString("password",e.password),t.abrupt("return",this._networkClient.fetchSDK({url:"/passwords/strength_check",method:"POST",errorMessage:"Failed to check password strength.",body:{email:e.email,password:e.password}}));case 2:case"end":return t.stop()}}),t,this)})))}}]),e}();Promise.resolve({pkceRequiredForEmailMagicLinks:!1}),Promise.resolve({pkceRequiredForPasswordResets:!1});var rt=function(){function e(t){T(this,e),this.iframeURL=t,this.createIframe()}return O(e,[{key:"createIframe",value:function(){var e=document.querySelector('[src~="'.concat(this.iframeURL,'"]'));e?ve("It looks like you're creating multiple copies of the Stytch client. This behavior is unsupported, and unintended side effects may occur. Make sure you are creating the Stytch client at the global level, and not inside a component's render function."):((e=document.createElement("iframe")).src=this.iframeURL,e.style.position="absolute",e.style.width="0",e.style.height="0",e.style.border="0",document.body.appendChild(e)),"true"!==e.dataset.loaded?this.frame=new Promise((function(t){e.addEventListener("load",(function(){e.dataset.loaded="true",t(e)}),{once:!0})})):this.frame=Promise.resolve(e)}},{key:"call",value:function(e,t){return G(this,void 0,void 0,w().mark((function r(){var n,i,o=this;return w().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.frame;case 2:return n=r.sent,i=new MessageChannel,r.abrupt("return",new Promise((function(r,s){var a;i.port1.onmessage=function(e){var t=e.data;i.port1.close(),t.success?r(t.payload):s(we.unmarshall(t.error))};var c={method:e,args:t};null===(a=n.contentWindow)||void 0===a||a.postMessage(c,o.iframeURL,[i.port2])})));case 5:case"end":return r.stop()}}),r,this)})))}}]),e}(),nt=function(){function e(t,r){var n=this;T(this,e),this._subscriptionService=t,this._headlessSessionClient=r,this._onDataChange=function(e){(null==e?void 0:e.session)?n.scheduleBackgroundRefresh():n.cancelBackgroundRefresh()},this._reauthenticateWithBackoff=function(){return G(n,void 0,void 0,w().mark((function t(){var r;return w().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:return t.prev=2,t.next=5,this._headlessSessionClient.authenticate();case 5:return t.abrupt("return",t.sent);case 8:if(t.prev=8,t.t0=t.catch(2),!e.isUnrecoverableError(t.t0)){t.next=12;break}return t.abrupt("return",Promise.reject(t.t0));case 12:return r++,t.next=15,new Promise((function(t){return setTimeout(t,e.timeoutForAttempt(r))}));case 15:t.next=1;break;case 17:case"end":return t.stop()}}),t,this,[[2,8]])})))},this.timeout=null,this._subscriptionService.subscribeToState(this._onDataChange)}return O(e,[{key:"performBackgroundRefresh",value:function(){var e=this;this._reauthenticateWithBackoff().then((function(){e.scheduleBackgroundRefresh()})).catch((function(t){ve("Session background refresh failed. Signalling to app that user is logged out.",{error:t}),e._subscriptionService.destroyState()}))}},{key:"scheduleBackgroundRefresh",value:function(){var t=this;this.cancelBackgroundRefresh(),this.timeout=setTimeout((function(){t.performBackgroundRefresh()}),e.REFRESH_INTERVAL_MS)}},{key:"cancelBackgroundRefresh",value:function(){null!==this.timeout&&(clearTimeout(this.timeout),this.timeout=null)}}],[{key:"timeoutForAttempt",value:function(e){return e=Math.min(e,7),Math.floor(350*Math.random())-175+2e3*Math.pow(2,e)}},{key:"isUnrecoverableError",value:function(e){return Q.includes(e.error_type)}}]),e}();nt.REFRESH_INTERVAL_MS=18e4;var it="bootstrap",ot=function(){function e(t,r,n){var i=this;h(this,e),this._publicToken=t,this._networkClient=r,this._dataLayer=n,this._bootstrapDataPromise=this._networkClient.fetchSDK({url:"/projects/bootstrap/".concat(this._publicToken),method:"GET",errorMessage:"Error fetching bootstrap data for SDK for ".concat(this._publicToken)}).then(e.mapBootstrapData).then((function(e){return i._dataLayer.setItem(it,JSON.stringify(e)),e})).catch((function(e){return function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).error.apply(e,fe.concat(r))}(e),{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1}}))}return f(e,[{key:"getSync",value:function(){var e=this._dataLayer.getItem(it);if(null===e)return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1};try{return JSON.parse(e)}catch(e){return{displayWatermark:!1,cnameDomain:null,emailDomains:["stytch.com"],captchaSettings:{enabled:!1},pkceRequiredForEmailMagicLinks:!1,pkceRequiredForPasswordResets:!1,pkceRequiredForOAuth:!1,pkceRequiredForSso:!1,slugPattern:null,createOrganizationEnabled:!1,passwordConfig:null,runDFPProtectedAuth:!1}}}},{key:"getAsync",value:function(){return this._bootstrapDataPromise}}],[{key:"mapBootstrapData",value:function(e){var t,r=null!==e.password_config?{ludsComplexity:e.password_config.luds_complexity,ludsMinimumCount:e.password_config.luds_minimum_count}:null;return{displayWatermark:!e.disable_sdk_watermark,captchaSettings:e.captcha_settings,cnameDomain:e.cname_domain,emailDomains:e.email_domains,pkceRequiredForEmailMagicLinks:e.pkce_required_for_email_magic_links,pkceRequiredForPasswordResets:e.pkce_required_for_password_resets,pkceRequiredForOAuth:e.pkce_required_for_oauth,pkceRequiredForSso:e.pkce_required_for_sso,slugPattern:e.slug_pattern,createOrganizationEnabled:e.create_organization_enabled,passwordConfig:r,runDFPProtectedAuth:null!==(t=e.dfp_protected_auth_enabled)&&void 0!==t&&t,dfpProtectedAuthMode:e.dfp_protected_auth_mode}}}]),e}();function st(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}var at=f((function e(t){var r=this;h(this,e),this.bootstrapPromise=t,this.executeRecaptcha=function(){return st(r,void 0,void 0,d().mark((function e(){var t,r,n,i;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.state;case 2:if(t=e.sent,r=t.captchaClient,n=t.configured,i=t.siteKey,!n){e.next=10;break}return e.next=9,new Promise((function(e){return r.ready(e)}));case 9:return e.abrupt("return",r.execute(i,{action:"LOGIN"}));case 10:case"end":return e.stop()}}),e,this)})))},this.state=t.then((function(e){return st(r,void 0,void 0,d().mark((function t(){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.captchaSettings.enabled){t.next=9;break}return t.t1=!0,t.next=4,r=e.captchaSettings.siteKey,le("https://www.google.com/recaptcha/enterprise.js?render=".concat(r),(function(){return window.grecaptcha.enterprise}));case 4:t.t2=t.sent,t.t3=e.captchaSettings.siteKey,t.t0={configured:t.t1,captchaClient:t.t2,siteKey:t.t3},t.next=10;break;case 9:t.t0={configured:!1};case 10:return t.abrupt("return",t.t0);case 11:case"end":return t.stop()}}),t)})))}))})),ct=function(){function e(t){var r=this;h(this,e),this.iframeURL=t,this.oneTapStart=function(e){return r.call("oneTapStart",e)},this.oneTapSubmit=function(e){return r.call("oneTapSubmit",e)}}return f(e,[{key:"frameClient",get:function(){var e;return this._frameClient=null!==(e=this._frameClient)&&void 0!==e?e:new rt(this.iframeURL),this._frameClient}},{key:"call",value:function(e,t){return this.frameClient.call(e,[t])}}]),e}();function ut(e){return ut="function"==typeof Symbol&&"symbol"==_(Symbol.iterator)?function(e){return _(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_(e)},ut(e)}function lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,i=function(e){if("object"!==ut(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!==ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===ut(i)?i:String(i)),n)}var i}function dt(e,t,r){return t&&lt(e.prototype,t),r&&lt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}function ft(e){var t=yt();return function(){var r,n=gt(e);if(t){var i=gt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"===ut(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vt(e)}(this,r)}}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _t(e){var t="function"==typeof Map?new Map:void 0;return _t=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return mt(e,arguments,gt(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),bt(n,e)},_t(e)}function mt(e,t,r){return mt=yt()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&bt(i,r.prototype),i},mt.apply(null,arguments)}function yt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(m){return!1}}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(e)}t.lk=void 0,function(e){e.emailMagicLinks="emailMagicLinks",e.oauth="oauth",e.otp="otp",e.crypto="crypto",e.passwords="passwords"}(t.lk||(t.lk={})),t.mz=void 0,function(e){e.Google="google",e.Microsoft="microsoft",e.Apple="apple",e.Github="github",e.GitLab="gitlab",e.Facebook="facebook",e.Discord="discord",e.Salesforce="salesforce",e.Slack="slack",e.Amazon="amazon",e.Bitbucket="bitbucket",e.LinkedIn="linkedin",e.Coinbase="coinbase",e.Twitch="twitch",e.Twitter="twitter",e.TikTok="tiktok",e.Snapchat="snapchat",e.Figma="figma",e.Yahoo="yahoo"}(t.mz||(t.mz={})),t.Th=void 0,function(e){e.Vessel="Vessel",e.Phantom="Phantom",e.Metamask="Metamask",e.Coinbase="Coinbase",e.Binance="Binance",e.GenericEthereumWallet="Other Ethereum Wallet",e.GenericSolanaWallet="Other Solana Wallet"}(t.Th||(t.Th={})),t.sn=void 0,function(e){e.embedded="embedded",e.floating="floating"}(t.sn||(t.sn={})),t.cB=void 0,function(e){e.SMS="sms",e.WhatsApp="whatsapp",e.Email="email"}(t.cB||(t.cB={})),t.Ip=void 0,function(e){e.MagicLinkLoginOrCreateEvent="MAGIC_LINK_LOGIN_OR_CREATE",e.OTPsLoginOrCreateEvent="OTP_LOGIN_OR_CREATE",e.OTPsAuthenticate="OTP_AUTHENTICATE",e.CryptoWalletAuthenticateStart="CRYPTO_WALLET_AUTHENTICATE_START",e.CryptoWalletAuthenticate="CRYPTO_WALLET_AUTHENTICATE",e.PasswordCreate="PASSWORD_CREATE",e.PasswordAuthenticate="PASSWORD_AUTHENTICATE",e.PasswordResetByEmailStart="PASSWORD_RESET_BY_EMAIL_START",e.PasswordResetByEmail="PASSWORD_RESET_BY_EMAIL",e.B2BMagicLinkEmailLoginOrSignup="B2B_MAGIC_LINK_EMAIL_LOGIN_OR_SIGNUP",e.B2BMagicLinkAuthenticate="B2B_MAGIC_LINK_AUTHENTICATE",e.B2BMagicLinkEmailDiscoverySend="B2B_MAGIC_LINK_EMAIL_DISCOVERY_SEND",e.B2BMagicLinkDiscoveryAuthenticate="B2B_MAGIC_LINK_DISCOVERY_AUTHENTICATE",e.B2BSSOStart="B2B_SSO_START",e.B2BSSOAuthenticate="B2B_SSO_AUTHENTICATE",e.B2BOAuthAuthenticate="B2B_SSO_AUTHENTICATE",e.B2BOAuthDiscoveryAuthenticate="B2B_OAUTH_DISCOVERY_AUTHENTICATE",e.B2BDiscoveryOrganizationsCreate="B2B_DISCOVERY_ORGANIZATIONS_CREATE",e.B2BDiscoveryIntermediateSessionExchange="B2B_DISCOVERY_INTERMEDIATE_SESSION_EXCHANGE",e.B2BPasswordAuthenticate="B2B_PASSWORD_AUTHENTICATE",e.B2BPasswordResetByEmailStart="B2B_PASSWORD_RESET_BY_EMAIL_START",e.B2BPasswordResetByEmail="B2B_PASSWORD_RESET_BY_EMAIL",e.B2BPasswordResetBySession="B2B_PASSWORD_RESET_BY_SESSION"}(t.Ip||(t.Ip={}));var kt=function(){pt(t,_t(Error));var e=ft(t);function t(r,n){var i;return ht(this,t),(i=e.call(this,r+"\n"+n)).message=r+"\n"+n,i.name="SDKAPIUnreachableError",i.details=n,Object.setPrototypeOf(vt(i),t.prototype),i}return dt(t)}(),wt=function(){pt(t,_t(Error));var e=ft(t);function t(r,n){var i;return ht(this,t),(i=e.call(this)).name="StytchSDKUsageError",i.message="Invalid call to ".concat(r,"\n")+n,i}return dt(t)}(),St=function(){pt(t,_t(Error));var e=ft(t);function t(r){var n,i;ht(this,t),(n=e.call(this)).name="StytchSDKSchemaError";var o=null===(i=r.body)||void 0===i?void 0:i.map((function(e){return"".concat(e.dataPath,": ").concat(e.message)})).join("\n");return n.message="[400] Request does not match expected schema\n".concat(o),n}return dt(t)}(),Ot=function(){pt(t,_t(Error));var e=ft(t);function t(r){var n;ht(this,t),(n=e.call(this)).name="StytchSDKAPIError";var i=r.status_code,o=r.error_type,s=r.error_message,a=r.error_url,c=r.request_id;return n.error_type=o,n.error_message=s,n.error_url=a,n.request_id=c,n.status_code=i,n.message="[".concat(i,"] ").concat(o,"\n")+"".concat(s,"\n")+"See ".concat(a," for more information.\n")+(c?"request_id: ".concat(c,"\n"):""),n}return dt(t)}(),Tt=function(){pt(t,_t(Error));var e=ft(t);function t(r){var n;return ht(this,t),(n=e.call(this)).name="StytchSDKNativeError",n.error_type=r,n.message="".concat(r),n}return dt(t)}();t.Dd=void 0,function(e){e.BiometricsSensorError="biometrics_sensor_error",e.DeviceCredentialsNotAllowed="device_credentials_not_allowed",e.DeviceHardwareError="device_hardware_error",e.InternalError="internal_error",e.KeyInvalidated="key_invalidated",e.KeystoreUnavailable="keystore_unavailable",e.NoBiometricsEnrolled="no_biometrics_enrolled",e.NoBiometricsRegistration="no_biometrics_registration",e.SessionExpired="session_expired",e.UserCancellation="user_cancellation",e.UserLockedOut="user_locked_out",e.BiometricsNotAvailable="biometrics_not_available"}(t.Dd||(t.Dd={})),t.Ll=void 0,function(e){e.emailMagicLinks="emailMagicLinks",e.sso="sso",e.passwords="passwords",e.oauth="oauth"}(t.Ll||(t.Ll={})),t.VV=void 0,function(e){e.Discovery="Discovery",e.Organization="Organization",e.PasswordReset="PasswordReset"}(t.VV||(t.VV={})),t.W7=void 0,function(e){e.Google="google",e.Microsoft="microsoft"}(t.W7||(t.W7={}));var Ct=function(e){s(n,e);var r=c(n);function n(e,i,o,s,a,c){var l;return h(this,n),(l=r.call(this,e,i,o,s,a))._oneTap=c,l.startOneTap=function(e){return st(u(l),void 0,void 0,d().mark((function r(){var n,i,o;return d().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._oneTap.createOneTapClient();case 2:if((n=r.sent).success){r.next=5;break}throw new Error("One Tap could not load: ".concat(n.reason));case 5:return i=n.client,o=this._oneTap.createOnSuccessHandler({signupRedirectUrl:e.signup_redirect_url,loginRedirectUrl:e.login_redirect_url,onSuccess:this._oneTap.RedirectOnSuccess}),r.abrupt("return",i.render({style:{position:t.sn.floating},onOneTapCancelled:e.onOneTapCancelled,callback:o}));case 7:case"end":return r.stop()}}),r,this)})))},l.googleOneTap={start:l.startOneTap},l}return f(n)}(xe),At=function(){function e(t,r,n,i){h(this,e),this._publicToken=t,this._subscriptionDataLayer=r,this.baseURL=n,this.additionalTelemetryDataFn=i,this.updateSessionToken=function(){return null},this.eventLogger=new Se({maxBatchSize:15,intervalDurationMs:800,logEventURL:this.buildSDKUrl("/events")})}return f(e,[{key:"logEvent",value:function(e){var t=e.name,r=e.details,n=e.error,i=void 0===n?{}:n;this.eventLogger.logEvent(this.createTelemetryBlob(),{public_token:this._publicToken,event_name:t,details:r,error_code:i.error_code,error_description:i.error_description,http_status_code:i.http_status_code})}},{key:"createTelemetryBlob",value:function(){return Object.assign(Object.assign({event_id:"event-id-".concat(ce()),app_session_id:"app-session-id-".concat(ce()),persistent_id:"persistent-id-".concat(ce()),client_sent_at:(new Date).toISOString(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},this.additionalTelemetryDataFn()),{app:{identifier:window.location.hostname},sdk:{identifier:"Stytch.js Javascript SDK",version:"2.2.2"}})}},{key:"fetchSDK",value:function(e){var t=e.url,r=e.body,n=e.errorMessage,i=e.method;return st(this,void 0,void 0,d().mark((function e(){var o,s,a,c;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this._subscriptionDataLayer.readSessionCookie().session_token,s="Basic "+window.btoa(this._publicToken+":"+(o||this._publicToken)),a=window.btoa(JSON.stringify(this.createTelemetryBlob())),c=window.location.origin,e.abrupt("return",re({basicAuthHeader:s,body:r,errorMessage:n,finalURL:this.buildSDKUrl(t),method:i,xSDKClientHeader:a,xSDKParentHostHeader:c}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"retriableFetchSDK",value:function(e){var t=e.url,r=e.body,n=e.errorMessage,i=e.method,o=e.retryCallback;return st(this,void 0,void 0,d().mark((function e(){var s,a,c,u;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this._subscriptionDataLayer.readSessionCookie().session_token,a="Basic "+window.btoa(this._publicToken+":"+(s||this._publicToken)),c=window.btoa(JSON.stringify(this.createTelemetryBlob())),u=window.location.origin,e.abrupt("return",function(e){var t=e.method,r=e.errorMessage,n=e.finalURL,i=e.basicAuthHeader,o=e.xSDKClientHeader,s=e.xSDKParentHostHeader,a=e.body,c=e.retryCallback;return G(this,void 0,void 0,w().mark((function e(){var u;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={method:t,errorMessage:r,finalURL:n,basicAuthHeader:i,xSDKClientHeader:o,xSDKParentHostHeader:s,body:a},e.prev=1,e.next=4,re(u);case 4:case 15:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),!(e.t0 instanceof te)){e.next=16;break}return e.next=12,c(e.t0,u);case 12:return u=e.sent,e.next=15,re(u);case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,7]])})))}({basicAuthHeader:a,body:r,errorMessage:n,finalURL:this.buildSDKUrl(t),method:i,xSDKClientHeader:c,xSDKParentHostHeader:u,retryCallback:o}));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"buildSDKUrl",value:function(e){return"".concat(this.baseURL,"/sdk/v1").concat(e)}}]),e}(),Et=function(){function e(t,r,n){h(this,e),this._googleClient=t,this._publicToken=r,this._clientId=n}return f(e,[{key:"cancel",value:function(){this._googleClient.cancel()}},{key:"render",value:function(e){var r=e.callback,n=e.onOneTapCancelled,i=e.style;return st(this,void 0,void 0,d().mark((function e(){var o,s=this;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={client_id:this._clientId,callback:r,auto_select:!1,context:"use",itp_support:!0},e.abrupt("return",(i.position===t.sn.embedded&&(o.prompt_parent_id="google-parent-prompt",o.cancel_on_tap_outside=!1),this._googleClient.initialize(o),new Promise((function(e){s._googleClient.prompt((function(t){return t.isSkippedMoment()?("user_cancel"===t.getSkippedReason()&&(null==n||n()),e({success:!1,reason:t.getSkippedReason()})):t.isNotDisplayed()?e({success:!1,reason:t.getNotDisplayedReason()}):(s.styleFrame(i),e({success:!0}))}))}))));case 2:case"end":return e.stop()}}),e,this)})))}},{key:"styleFrame",value:function(e){e.position===t.sn.embedded&&Array.from(document.getElementsByTagName("iframe")).forEach((function(e){e.src.includes(U)&&(e.style.width="100%")}))}}]),e}(),xt=function(){function e(t,r){var n=this;h(this,e),this._publicToken=t,this.clientsideServices=r,this.createOnSuccessHandler=function(e){var t=e.loginRedirectUrl,r=e.signupRedirectUrl,i=e.onSuccess;return function(e){return st(n,void 0,void 0,d().mark((function n(){var o,s,a;return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.credential,n.next=3,this.submitGoogleOneTapToken({credential:o,loginRedirectUrl:t,signupRedirectUrl:r});case 3:s=n.sent,a=s.redirect_url,i(a);case 6:case"end":return n.stop()}}),n,this)})))}},this.RedirectOnSuccess=function(e){window.location.href=e}}return f(e,[{key:"createOneTapClient",value:function(){return st(this,void 0,void 0,d().mark((function e(){var t,r;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.fetchGoogleStart();case 3:r=e.sent,t=r.googleClientId,e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{success:!1,reason:e.t0.error_type});case 10:if(""!==t){e.next=12;break}return e.abrupt("return",{success:!1,reason:"oauth_config_not_found"});case 12:return e.t1=!0,e.t2=Et,e.next=16,le(K,(function(){return window.google.accounts.id}));case 16:return e.t3=e.sent,e.t4=this._publicToken,e.t5=t,e.t6=new e.t2(e.t3,e.t4,e.t5),e.abrupt("return",{success:e.t1,client:e.t6});case 21:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"fetchGoogleStart",value:function(){return this.googleConfig||(this.googleConfig=this.clientsideServices.oneTapStart({publicToken:this._publicToken})),this.googleConfig}},{key:"submitGoogleOneTapToken",value:function(e){var t=e.credential,r=e.loginRedirectUrl,n=e.signupRedirectUrl;return st(this,void 0,void 0,d().mark((function e(){var i,o;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchGoogleStart();case 2:return i=e.sent,o=i.oauthCallbackId,e.abrupt("return",this.clientsideServices.oneTapSubmit({publicToken:this._publicToken,idToken:t,loginRedirectURL:r,oauthCallbackID:o,signupRedirectURL:n}));case 5:case"end":return e.stop()}}),e,this)})))}}],[{key:"WillGoogleOneTapShowBannerForUA",value:function(e){var t=function(e,t){return-1!==e.indexOf(t)},r=t(e,"iPad")||t(e,"Android")&&!t(e,"Mobile")||t(e,"Silk"),n=t(e,"iPod")||t(e,"iPhone")||t(e,"Android")||t(e,"IEMobile");return!r&&n}},{key:"WillGoogleOneTapShowEmbedded",value:function(){return!e.WillGoogleOneTapShowBannerForUA(navigator.userAgent)}}]),e}();function Pt(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t}var Rt=function(){function e(t,r){h(this,e),this._dataLayer=t,this.namespace=r}return f(e,[{key:"key",value:function(){return"PKCE_VERIFIER:"+this.namespace}},{key:"startPKCETransaction",value:function(){return st(this,void 0,void 0,d().mark((function t(){var r;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.createProofkeyPair();case 2:return r=t.sent,t.abrupt("return",(this._dataLayer.setItem(this.key(),JSON.stringify(r)),r));case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getPKPair",value:function(){var e=this._dataLayer.getItem(this.key());if(null!==e)try{return JSON.parse(e)}catch(e){return void ve("Found malformed Proof Key pair in localstorage.")}}},{key:"clearPKPair",value:function(){return this._dataLayer.removeItem(this.key())}}],[{key:"createProofkeyPair",value:function(){return st(this,void 0,void 0,d().mark((function e(){var t,r,i,o,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Uint32Array(16),window.crypto.getRandomValues(r),i=Array.from(r).map(Pt).join(""),e.next=5,window.crypto.subtle.digest("SHA-256",(new TextEncoder).encode(i));case 5:return o=e.sent,e.abrupt("return",{code_challenge:(s=o,btoa((t=String.fromCharCode).call.apply(t,[null].concat(n(new Uint8Array(s))))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),code_verifier:i});case 7:case"end":return e.stop()}}),e)})))}}]),e}(),Dt=function(){function e(t){h(this,e),this._networkClient=t}return f(e,[{key:"searchUser",value:function(e){return this._networkClient.fetchSDK({url:"/users/search",method:"POST",body:{email:e},errorMessage:"Error searching for user ".concat(e)})}},{key:"searchOrganization",value:function(e){return this._networkClient.fetchSDK({url:"/b2b/organizations/search",method:"POST",body:{organization_slug:e},errorMessage:"Error searching slug"})}},{key:"searchMember",value:function(e,t){return this._networkClient.fetchSDK({url:"/b2b/organizations/members/search",method:"POST",body:{email_address:e,organization_id:t},errorMessage:"Error searching for member ".concat(e)})}}]),e}(),Lt=function(e){return(document.cookie?document.cookie.split("; "):[]).filter((function(t){var n=r(t.split("="),1)[0];return e===n})).length>1};function It(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}var Bt=function e(t,r){function n(e,n,i){if("undefined"!=typeof document){"number"==typeof(i=It({},r,i)).expires&&(i.expires=new Date(Date.now()+864e5*i.expires)),i.expires&&(i.expires=i.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var s in i)i[s]&&(o+="; "+s,!0!==i[s]&&(o+="="+i[s].split(";")[0]));return document.cookie=e+"="+t.write(n,e)+o}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],n={},i=0;i<r.length;i++){var o=r[i].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(n[a]=t.read(s,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){n(e,"",It({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,It({},this.attributes,t))},withConverter:function(t){return e(It({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),jt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"stytch_sdk_state_".concat(e).concat(t?"::".concat(t):"")},Ft=function(){function e(t,r){var n=this;h(this,e),this.browserSessionStorage={getItem:function(e){return sessionStorage.getItem(jt(n.publicToken,e))},setItem:function(e,t){return sessionStorage.setItem(jt(n.publicToken,e),t)},removeItem:function(e){return sessionStorage.removeItem(jt(n.publicToken,e))}},this.publicToken=t,this.state=null,this.subscriptions={},(null==r?void 0:r.cookieOptions)?(me("SubscriptionDataLayer").isOptionalString("cookieOptions.opaqueTokenCookieName",r.cookieOptions.opaqueTokenCookieName).isOptionalString("cookieOptions.jwtCookieName",r.cookieOptions.jwtCookieName).isOptionalString("cookieOptions.istCookieName",r.cookieOptions.istCookieName).isOptionalString("cookieOptions.path",r.cookieOptions.path).isOptionalString("cookieOptions.domain",r.cookieOptions.domain),this._jwtCookieName=r.cookieOptions.jwtCookieName||null,this._opaqueTokenCookieName=r.cookieOptions.opaqueTokenCookieName||null,this._cookiePath=r.cookieOptions.path||null,this._domain=r.cookieOptions.domain||null,this._cookieAvailableToSubdomains=r.cookieOptions.availableToSubdomains||!1,this._istCookieName=r.cookieOptions.istCookieName||null):(this._opaqueTokenCookieName=null,this._jwtCookieName=null,this._cookiePath=null,this._domain=null,this._cookieAvailableToSubdomains=!1,this._istCookieName=null);var i=localStorage.getItem(jt(this.publicToken));if(i){var o;try{o=JSON.parse(i)}catch(t){return void this.syncToLocalStorage()}this.state=o}}return f(e,[{key:"opaqueTokenCookieName",get:function(){var e;return null!==(e=this._opaqueTokenCookieName)&&void 0!==e?e:"stytch_session"}},{key:"jwtCookieName",get:function(){var e;return null!==(e=this._jwtCookieName)&&void 0!==e?e:"stytch_session_jwt"}},{key:"istCookieName",get:function(){var e;return null!==(e=this._istCookieName)&&void 0!==e?e:"stytch_intermediate_session_token"}},{key:"readSessionCookie",value:function(){return{session_token:Bt.get(this.opaqueTokenCookieName),session_jwt:Bt.get(this.jwtCookieName)}}},{key:"readIntermediateSessionTokenCookie",value:function(){return Bt.get(this.istCookieName)}},{key:"writeSessionCookie",value:function(t){var r,n,i,o,s=t.state,a=t.session_token,c=t.session_jwt,u=e.generateCookieOpts({expiresAt:null!==(n=null===(r=null==s?void 0:s.session)||void 0===r?void 0:r.expires_at)&&void 0!==n?n:"",availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Bt.set(this.opaqueTokenCookieName,a,u),Bt.set(this.jwtCookieName,c,u);var l=e.generateCookieOpts({expiresAt:null!==(o=null===(i=null==s?void 0:s.session)||void 0===i?void 0:i.expires_at)&&void 0!==o?o:"",availableToSubdomains:!this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Lt(this.jwtCookieName)&&Bt.remove(this.jwtCookieName,l),Lt(this.opaqueTokenCookieName)&&Bt.remove(this.opaqueTokenCookieName,l),Lt(this.jwtCookieName)&&ve("Could not remove extraneous JWT cookie. This might happen if the cookie has been set using multiple `path` settings, and may produce unwanted behavior."),Lt(this.opaqueTokenCookieName)&&ve("Could not remove extraneous opaque token cookie.")}},{key:"writeIntermediateSessionTokenCookie",value:function(t){var r=new Date(Date.now()+6e5),n=e.generateCookieOpts({expiresAt:r.toString(),availableToSubdomains:this._cookieAvailableToSubdomains,path:this._cookiePath,domain:this._domain});Bt.set(this.istCookieName,t,n)}},{key:"removeSessionCookie",value:function(){this.removeCookies([this.opaqueTokenCookieName,this.jwtCookieName])}},{key:"removeISTCookie",value:function(){this.removeCookies([this.istCookieName])}},{key:"removeCookies",value:function(t){var r=this;[!0,!1].forEach((function(n){[r._cookiePath,null].forEach((function(i){[r._domain,null].forEach((function(r){var o=e.generateCookieOpts({expiresAt:new Date(0).toString(),availableToSubdomains:n,path:i,domain:r});t.forEach((function(e){Bt.remove(e,o)}))}))}))}))}},{key:"syncToLocalStorage",value:function(){localStorage.setItem(jt(this.publicToken),JSON.stringify(this.state))}},{key:"getItem",value:function(e){return localStorage.getItem(jt(this.publicToken,e))}},{key:"setItem",value:function(e,t){return localStorage.setItem(jt(this.publicToken,e),t)}},{key:"removeItem",value:function(e){return localStorage.removeItem(jt(this.publicToken,e))}}],[{key:"generateCookieOpts",value:function(e){var t=e.path,r=e.domain,n=e.availableToSubdomains,i=e.expiresAt,o={expires:new Date(i),sameSite:"lax"};return t&&(o.path=t),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))?o.secure=!1:(n&&(o.domain=r||window.location.host),o.secure=!0),o}}]),e}(),Nt=function(e){s(r,e);var t=c(r);function r(){return h(this,r),t.apply(this,arguments)}return f(r)}(Ft),Mt=Symbol.for("__stytch_DataLayer"),Ut=function(e,t){Object.values(e).forEach((function(e){return e(t)}))},Kt=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).KEYS_TO_EXCLUDE,t=void 0===e?[]:e;return function e(r,n){return k(r)===k(n)&&(null===r||null===n?r===n:"object"===k(r)?Object.keys(r).length===Object.keys(n).length&&!Object.keys(r).some((function(e){return!(e in n)}))&&Object.entries(r).filter((function(e){var r=y(e,1)[0];return!t.includes(r)})).every((function(t){var r=y(t,2),i=r[0],o=r[1];return e(o,n[i])})):r===n)}}({KEYS_TO_EXCLUDE:["last_accessed_at"]}),Wt=function(){function e(t,r){var n,i=this;h(this,e),this._publicToken=t,this._datalayer=r,this._listen=function(e){if(e.key===jt(i._publicToken))if(null!==e.newValue&&"null"!==e.newValue){var t=JSON.parse(e.newValue);i.updateState(t)}else i.destroyState()},window.addEventListener("storage",this._listen);var o=null===(n=this._datalayer.state)||void 0===n?void 0:n.session;o&&Date.parse(o.expires_at)<Date.now()?this.destroyState():this._datalayer.readSessionCookie().session_token||this.destroyState()}return f(e,[{key:"getTokens",value:function(){var e=this._datalayer.readSessionCookie(),t=e.session_token,r=e.session_jwt;return"string"!=typeof t||"string"!=typeof r?null:{session_token:t,session_jwt:r}}},{key:"getIntermediateSessionToken",value:function(){return this._datalayer.readIntermediateSessionTokenCookie()||null}},{key:"destroyState",value:function(){this.updateStateAndTokens({state:null,session_token:null,session_jwt:null,intermediate_session_token:null})}},{key:"_updateStateAndTokensInternal",value:function(e){var t=this._datalayer.state,r=null===e.state?null:Object.assign(Object.assign({},this._datalayer.state),e.state);this._datalayer.state=r,Kt(t,r)||Ut(this._datalayer.subscriptions,r)}},{key:"updateStateAndTokens",value:function(e){e.state?(this._datalayer.writeSessionCookie(e),this._datalayer.removeISTCookie()):e.intermediate_session_token?(this._datalayer.writeIntermediateSessionTokenCookie(e.intermediate_session_token),this._datalayer.removeSessionCookie()):(this._datalayer.removeSessionCookie(),this._datalayer.removeISTCookie()),this._updateStateAndTokensInternal(e),this._datalayer.syncToLocalStorage()}},{key:"updateState",value:function(e){var t=this._datalayer.state,r=null===e?null:Object.assign(Object.assign({},this._datalayer.state),e);this._datalayer.state=r,Kt(t,r)||(Ut(this._datalayer.subscriptions,r),this._datalayer.syncToLocalStorage())}},{key:"updateTokens",value:function(e){var t=e.session_token,r=e.session_jwt,n=this._datalayer.readSessionCookie(),i=Object.assign(Object.assign({},n),{session_token:t,session_jwt:r});t||r?(this._datalayer.writeSessionCookie(i),this._datalayer.removeISTCookie()):this._datalayer.removeSessionCookie()}},{key:"subscribeToState",value:function(e){return function(e,t){var r=Math.random().toString(36).slice(-10);return e[r]=t,function(){return delete e[r]}}(this._datalayer.subscriptions,e)}},{key:"getState",value:function(){return this._datalayer.state}},{key:"destroy",value:function(){window.removeEventListener("storage",this._listen)}},{key:"syncFromDeviceStorage",value:function(){return null}}]),e}(),Gt=function(e){s(r,e);var t=c(r);function r(){var e;return h(this,r),(e=t.apply(this,arguments)).updateUser=function(t){return e.updateState({user:t})},e.getUser=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.user)&&void 0!==r?r:null},e.getSession=function(){var t,r;return null!==(r=null===(t=e.getState())||void 0===t?void 0:t.session)&&void 0!==r?r:null},e}return f(r)}(Wt),qt=Symbol.for("stytch__internal_b2c");t.Gi=function(){return f((function e(t,r){var n,i=this;h(this,e),function(e){if("undefined"==typeof window)throw new Error("The ".concat(e," is not compatible with server-side environments.\nIf using nextjs, use the create").concat(e," method instead.\n```\n").concat("import { createStytchHeadlessClient } from '@stytch/nextjs/ui';\n    \nconst stytch = createStytchHeadlessClient('public-token-...');\n","\n```\n"))}("StytchHeadlessClient"),"string"!=typeof(n=t)?ve("Public token is malformed. Expected a string, got ".concat(k(n),".").concat(_e)):""===n?ve('Public token is malformed. Expected "public-token-...", got an empty string.'.concat(_e)):n.startsWith("public-token-")||ve('Public token is malformed. Expected "public-token-...", got '.concat(n,".").concat(_e));var o,s,a,c,u,l,d,p,f,_,m,y=r,b={cookieOptions:null==(o=y)?void 0:o.cookieOptions,endpoints:{sdkBackendURL:null!==(a=null===(s=null==o?void 0:o.endpoints)||void 0===s?void 0:s.sdkBackendURL)&&void 0!==a?a:"https://web.stytch.com",testAPIURL:null!==(u=null===(c=null==o?void 0:o.endpoints)||void 0===c?void 0:c.testAPIURL)&&void 0!==u?u:"https://test.stytch.com",liveAPIURL:null!==(d=null===(l=null==o?void 0:o.endpoints)||void 0===l?void 0:l.liveAPIURL)&&void 0!==d?d:"https://api.stytch.com",dfpBackendURL:null!==(f=null===(p=null==o?void 0:o.endpoints)||void 0===p?void 0:p.dfpBackendURL)&&void 0!==f?f:"https://telemetry.stytch.com",clientsideServicesIframeURL:null!==(m=null===(_=null==o?void 0:o.endpoints)||void 0===_?void 0:_.clientsideServicesIframeURL)&&void 0!==m?m:"https://js.stytch.com/clientside-services/index.html"}};this._dataLayer=function(e,t){var r=function(){var e=window;return e[Mt]||(e[Mt]={}),e[Mt]}();return r[e]||(r[e]=new Nt(e,t)),r[e]}(t,y),this._subscriptionService=new Gt(t,this._dataLayer);var g=new Rt(this._dataLayer,"passwords");this._networkClient=new At(t,this._dataLayer,b.endpoints.sdkBackendURL,(function(){var e,t,r,n;return{stytch_user_id:null===(t=null===(e=i._dataLayer.state)||void 0===e?void 0:e.user)||void 0===t?void 0:t.user_id,stytch_session_id:null===(n=null===(r=i._dataLayer.state)||void 0===r?void 0:r.session)||void 0===n?void 0:n.session_id}}));var w,S,O,T,C=new ot(t,this._networkClient,this._dataLayer),A=new at(C.getAsync()),E=new ge(t,b.endpoints.dfpBackendURL,C.getAsync(),A.executeRecaptcha),x=new ct(b.endpoints.clientsideServicesIframeURL),P=new xt(t,x),R=new Dt(this._networkClient);this.user=new Oe(this._networkClient,this._subscriptionService),this.session=new Te(this._networkClient,this._subscriptionService),this.magicLinks=new Ae(this._networkClient,this._subscriptionService,new Rt(this._dataLayer,"magic_links"),g,C.getAsync(),E),this.otps=new Ee(this._networkClient,this._subscriptionService,A.executeRecaptcha,E),this.oauth=new Ct(this._networkClient,this._subscriptionService,new Rt(this._dataLayer,"oauth"),C.getAsync(),{publicToken:t,testAPIURL:b.endpoints.testAPIURL,liveAPIURL:b.endpoints.liveAPIURL},P),this.cryptoWallets=new Pe(this._networkClient,this._subscriptionService,A.executeRecaptcha,E),this.totps=new Re(this._networkClient,this._subscriptionService,E),this.webauthn=new Qe(this._networkClient,this._subscriptionService,E),this.passwords=new tt(this._networkClient,this._subscriptionService,g,C.getAsync(),E),this._sessionManager=new nt(this._subscriptionService,this.session),this._dataLayer.readSessionCookie().session_token&&this._sessionManager.performBackgroundRefresh(),this._networkClient.logEvent({name:"sdk_instance_instantiated",details:{event_callback_registered:!1,error_callback_registered:!1,success_callback_registered:!1}}),w={bootstrap:C,clientsideServices:x,captcha:A,oneTap:P,searchManager:R,publicToken:t,dataLayer:this._dataLayer,networkClient:this._networkClient},Object.assign(this,(S={},T=w,(O=v(O=qt))in S?Object.defineProperty(S,O,{value:T,enumerable:!0,configurable:!0,writable:!0}):S[O]=T,S))}))}()}}]);
//# sourceMappingURL=8f964933-b2fb0453f687e7771d73.js.map